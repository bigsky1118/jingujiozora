<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>名簿登録</title>
</head>
<style>
    body{
        padding: 1em 3em;
        margin: 0 auto;
    }
    li{
        list-style: none;
    }
    dl{
        display: flex;
        flex-direction: column;
        justify-content: start;
        align-items:flex-start;
        margin-bottom: 1em;
    }
    dt{
        width: 5em;
    }
    dd{
        margin: 0;
    }
</style>
<body>
    <form>
        <h2>名簿登録</h2>
        <div id="inputform">
            <dl>
                <dt>姓</dt>
                <dd><input type="text" name="lastname" required></dd>
            </dl>
            <dl>
                <dt>名</dt>
                <dd><input type="text" name="firstname" required></dd>
            </dl>
            <dl>
                <dt>旧姓</dt>
                <dd><input type="text" name="pastname"></dd>
            </dl>
            <dl>
                <dt>卒業組</dt>
                <dd>
                    <select name="graduate" id="" required>
                        <option value="1">1組 厚見学級</option>
                        <option value="2">2組 宮本学級</option>
                        <option value="1">3組 田村学級</option>
                        <option value="1">4組 浅野学級</option>
                        <option value="5">その他</option>
                    </select>
                </dd>
            </dl>
            <dl>
                <dt>電話番号</dt>
                <dd>
                    <input type="tel" name="tel" id="">
                </dd>
            </dl>
            <dl>
                <dt>メール</dt>
                <dd>
                    <input type="email" name="email" id="">
                </dd>
            </dl>
            <dl>
                <dt></dt>
                <dd>
                    <input type="submit" class="" value="送信">
                </dd>
            </dl>
        </div>
    </form>

    <script>

        $(document).ready(function () {
            const liffId = "1657466094-xyG8jZWY";
            initializeLiff(liffId);
        })

        function initializeLiff(liffId) {
            liff.init({
                liffId: liffId
            }).then(() => {
                initializeApp();
            }).catch((err) => {
                console.log('LIFF Initialization failed ', err);
            });
        }

        function sendText(text) {
            liff.sendMessages([{
                'type': 'text',
                'text': text
            }]).then(function () {
                liff.closeWindow();
            }).catch(function (error) {
                window.alert('Failed to send message ' + error);
            });
        }

        const params = (new URL(document.location)).searchParams;
        const key = params.get('key');

        $(function () {
            $('form').submit(function () {
                const lastname  = $('input[name="lastname"]').val();
                const firstname = $('input[name="firstname"]').val();
                const pastname  = $('input[name="pastname"]').val();
                const graduate  = $('select[name="graduate"]').val();
                const tel       = $('input[name="tel"]').val();
                const email     = $('input[name="email"]').val();
                const msg = `名簿登録\n${lastname}\n${firstname}\n${pastname}\n${tel}\n${email}`;
                sendText(msg);
                return false;
            });
        });

    </script>

</body>
</html>